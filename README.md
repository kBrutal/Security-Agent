# Security Automation Agent

## Overview

The Security Automation Agent is a Python-based system designed to automate security tasks such as port scanning, directory discovery, and fuzzing. It leverages Large Language Models (LLMs) to break down high-level security commands into specific tasks, executes these tasks using various security tools, and generates detailed reports summarizing the findings.

## System Architecture

The system is composed of several key components:

1. **Security Agent (`security_agent.py`)**: The main orchestrator that manages the workflow of the security tasks. It uses a state graph to handle task breakdown, dependency checking, task execution, and report generation.

2. **Task Handlers (`task_handlers.py`)**: Contains functions that handle the breakdown of high-level commands into specific tasks, check task dependencies, execute tasks, and generate final reports.

3. **Tool Executor (`tool_executor.py`)**: Responsible for executing specific security tools (e.g., `nmap`, `gobuster`, `ffuf`, `dig`) based on the tasks generated by the agent. It also handles the parsing and analysis of tool outputs.

4. **Graph State (`graph_state.py`)**: Defines the state structure used by the state graph to keep track of tasks, results, and other metadata during the execution of the security agent.

5. **Security Task (`security_task.py`)**: Defines the `SecurityTask` class, which represents individual tasks with attributes such as description, tool, target, dependencies, and parameters.

6. **Main Script (`main.py`)**: The entry point of the application. It initializes the security agent, runs the security tasks, and generates a summary of the findings using an LLM.

## Agent Roles and Responsibilities

- **Task Breakdown**: The agent uses an LLM to break down high-level security commands into a list of specific tasks. Each task includes a description, the tool to be used, the target, and any dependencies on previous tasks.

- **Dependency Management**: The agent ensures that tasks are executed in the correct order by checking dependencies before executing each task.

- **Task Execution**: The agent executes tasks using the appropriate security tools (e.g., `nmap` for port scanning, `gobuster` for directory discovery). It handles retries and alternate configurations if a task fails.

- **Result Parsing and Analysis**: After executing tasks, the agent parses the results and generates a summary of findings, including open ports, discovered directories, and potential vulnerabilities.

- **Report Generation**: The agent compiles the results into a final report, which includes details of each task, findings, and security recommendations.

## Scope Enforcement Strategy

The system enforces scope by checking the target domain or IP address against a predefined list of allowed domains and IP ranges specified in the `config.ini` file. If a target is not within the allowed scope, the system will either skip the task or create default tasks that are within the scope.

## Steps to Replicate and Run the Project

### Prerequisites

- **Python 3.11**: Ensure Python 3.11 is installed on your system.
- **System-Level Dependencies**: The following tools must be installed and available in your system's PATH:
    - `nmap`: Install via your package manager (e.g., `sudo apt-get install nmap` on Ubuntu).
    - `gobuster`: Install via your package manager (e.g., `sudo apt-get install gobuster` on Ubuntu).
    - `ffuf`: Download and install from [here](https://github.com/ffuf/ffuf).
    - `dig`: Typically included with the `dnsutils` package (e.g., `sudo apt-get install dnsutils` on Ubuntu).

    Only these tools have been integrated currently. However we can integrate more tools and specific tools based on requirements.

### Environment Setup

1. **Clone the Repository**:

    ```bash
    git clone https://github.com/your-repo/security-automation-agent.git
    cd security-automation-agent
    ```

2. **Set Up a Virtual Environment**:

    Using `venv`:

    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows use `venv\Scripts\activate`
    ```

3. **Install Dependencies**:

    Using `requirements.txt`:

    ```bash
    pip install -r requirements.txt
    ```

### Configuration

1. **Create a `config.ini` File**:

    This file should contain the following sections:

    ```ini
    [API]
    api_key = YOUR_GROQ_API_KEY

    [SCOPE]
    domains = google.com,wikipedia.org,youtube.com
    ip_ranges = 192.168.1.0/24,10.0.0.0/8
    ```

    Replace `YOUR_GROQ_API_KEY` with your actual Groq API key.

### Running the Project

1. **Execute the Main Script**:

    Run the `main.py` script to start the security agent:

    ```bash
    python main.py
    ```

2. **Review the Output**:

    The script will generate two files:
    - `security_report.txt`: Contains the detailed report of the security tasks and findings.
    - `security_summary.txt`: Contains a concise summary of the findings generated by the LLM.

3. **Customize the Command**:

    Modify the `command` variable in `main.py` to run different security tasks. For example:

    ```python
    command = "Fuzz the target domain langchain.com for hidden directories and files using common wordlists."
    ```

    This command will trigger the agent to perform fuzzing on the specified domain, discover hidden directories, and generate a report summarizing the findings.

## Conclusion

The Security Automation Agent is a powerful tool for automating security tasks, reducing manual effort, and ensuring consistent execution of security checks. By leveraging LLMs and popular security tools, it provides a comprehensive solution for security professionals to identify vulnerabilities and generate actionable insights.

---

**Note**: Ensure that all system-level dependencies (`nmap`, `gobuster`, `ffuf`, `dig`) are installed and accessible in your system's PATH before running the project.